// =============================================================================
// Models
// =============================================================================

model Document {
  id             String @id @default(cuid())
  documentNumber Int    @unique

  title       String
  description String?
  category    String?
  tags        String[]

  isPublic Boolean @default(false)
  isActive Boolean @default(true)

  createdById String
  createdBy   User   @relation("DocumentCreator", fields: [createdById], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  clientAccess DocumentAccess[]

  @@index([category])
  @@index([isPublic])
  @@index([isActive])
  @@index([createdById])
  @@index([createdAt])
  @@map("documents")
}

model DocumentAccess {
  documentId String
  document   Document @relation(fields: [documentId], references: [id], onDelete: Cascade)
  clientId   String
  client     Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)

  grantedById String
  grantedBy   User   @relation("DocumentAccessGranter", fields: [grantedById], references: [id])

  createdAt DateTime @default(now())

  @@id([documentId, clientId])
  @@index([documentId])
  @@index([clientId])
  @@index([grantedById])
  @@map("document_access")
}
